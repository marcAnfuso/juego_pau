/* ===== Variables y base ===== */
:root{
  --bg:#fff9f9; --fg:#2b2b2b;
  --primary:#e63946;
  --accent:#ffd166;
  --muted:#f3f3f3;
  --ok:#38b000; /* VERDE */
  --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.06);
}

*{ box-sizing: border-box; }

body {
  margin: 0;
  font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--fg);
  text-align: center;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.screen {
  padding: 20px;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  transition: opacity .5s ease;
}

.hidden { display: none; }

h1, h2 { color: var(--primary); }

button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  margin: 10px;
  font-size: 16px;
  cursor: pointer;
  transition: transform .2s ease;
  box-shadow: var(--shadow);
}
button:hover { transform: scale(1.05); }

.input-row {
  display: flex; justify-content: center; gap: 10px; margin: 15px 0;
}

input {
  padding: 10px; font-size: 16px; width: 80px;
  border-radius: 8px; border: 1px solid #ccc; background: #fff;
  box-shadow: var(--shadow);
}

.options {
  position: relative; /* para el botón que escapa */
  display: flex; flex-direction: column; gap: 10px; margin-top: 15px;
  min-height: 160px; overflow: hidden; padding: 8px;
}
@media (min-width: 460px) { .options { display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); } }
@media (min-width: 780px) { .options { grid-template-columns: repeat(3,minmax(0,1fr)); } }

.opt {
  background: #f1f1f1; color: #333; border: 1px solid #ddd;
}
.opt.correct { background: var(--ok); color: #40940b; border-color: transparent; }
.opt.wrong   { background: var(--primary); color: rgb(232, 22, 22); border-color: transparent; }

.progress { font-weight: bold; margin-bottom: 12px; display:flex; align-items:center; justify-content:center; gap:8px; }

/* Certificado */
#capture-area {
  background: white;
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 20px;
  margin: 20px auto 0;
  width: min(560px, 92vw);
  box-shadow: var(--shadow);
}

/* Hearts overlay */
#hearts { position: fixed; inset: 0; pointer-events: none; z-index: 0; }
#screen-final, #screen-proposal, #screen-novios, #screen-pause, #screen-game, #screen-intro { position: relative; z-index: 1; }

/* ===== Aparición suave (fade + slide) con stagger ===== */
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}
.reveal { opacity: 0; animation: fadeUp .42s ease forwards; animation-delay: var(--d, 0ms); }

/* brillo sutil */
@keyframes softGlow {
  0%,100% { text-shadow: 0 0 0 rgba(230,57,70,0); }
  50%     { text-shadow: 0 4px 18px rgba(230,57,70,.25); }
}
.title-glow { animation: softGlow 3.6s ease-in-out infinite; }

/* Anim pregunta */
@keyframes questionFade {
  from { opacity: 0; transform: translateY(12px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}
.question-anim { opacity: 0; animation: questionFade 0.45s ease forwards; }

.options .opt { opacity: 0; transform: translateY(10px); animation: fadeUp 0.35s ease forwards; }
.options .opt:nth-child(1) { animation-delay: 80ms; }
.options .opt:nth-child(2) { animation-delay: 160ms; }
.options .opt:nth-child(3) { animation-delay: 240ms; }

@keyframes popCorrect { 0%{transform:scale(1);}50%{transform:scale(1.08);}100%{transform:scale(1);} }
.opt.correct { animation: popCorrect 0.25s ease; }

/* Transición entre preguntas */
@keyframes qFadeIn  { from{opacity:0; transform:translateY(8px);} to{opacity:1; transform:translateY(0);} }
@keyframes qFadeOut { from{opacity:1; transform:translateY(0);} to{opacity:0; transform:translateY(-6px);} }
.q-enter{ animation: qFadeIn .32s ease forwards; }
.q-leave{ animation: qFadeOut .22s ease forwards; }

/* Pausa (10s) */
#screen-pause .pause-sub { color:#666; margin-bottom:6px; }
#pause-anim {
  width: min(520px, 92vw);
  height: 200px;
  margin: 10px auto 8px;
  border-radius: 16px;
  background: #fff;
  box-shadow: var(--shadow);
  position: relative; overflow: hidden;
}
.loader {
  width: 54px; height: 54px; margin: 12px auto 0; border-radius: 50%;
  border: 3px solid #eee; border-top-color: var(--primary);
  animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Barra de progreso capibaras */
.progressbar {
  width: min(560px, 92vw);
  height: 10px;
  background: #eee;
  border-radius: 999px;
  margin: 6px auto 14px;
  overflow: hidden;
  box-shadow: var(--shadow);
}
.progressbar-fill {
  height: 100%; width: 0%;
  background: linear-gradient(90deg, #b7efc5, #38b000);
  transition: width .35s ease;
}
@keyframes pulseOnce { 0%{transform:scale(1);}40%{transform:scale(1.18);}100%{transform:scale(1);} }
.capipulse { animation: pulseOnce .35s ease; }

/* Botón sonido */
.sound-btn{
  margin-left: 8px; font-size: 14px; padding: 6px 10px;
  border-radius: 999px; background: #fff; color: var(--fg); border: 1px solid #e8e8e8;
}
.sound-btn[aria-pressed="true"]{ background:#fef1f2; border-color:#f8c2c7; }

/* Accesibilidad */
.visually-hidden { position:absolute !important; width:1px; height:1px; margin:-1px; padding:0; overflow:hidden; clip:rect(0 0 0 0); border:0; }

@media (prefers-reduced-motion: reduce) {
  .reveal, .title-glow, .q-enter, .q-leave, .options .opt, .opt.correct, .loader { animation: none !important; }
}

/* Quitar el flash celestito en touch */
button, .opt {
  -webkit-tap-highlight-color: transparent;
}

/* No “apagues” el botón al deshabilitar */
.opt:disabled {
  opacity: 1;
  filter: none;
}

/* Mantener verde/rojo aun deshabilitado */
.opt.correct,
.opt.correct:disabled {
  background: var(--ok);
  color: #fff;
  border-color: transparent;
}

.opt.wrong,
.opt.wrong:disabled {
  background: var(--primary);
  color: #fff;
  border-color: transparent;
}

/* Opcional: evitar que el :focus deje borde raro en algunos móviles */
button:focus { outline: none; }

/* ===== Badge de acierto ===== */
.check-badge {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--ok);
  color: #fff;
  font-weight: 700;
  font-size: 13px;
  padding: 4px 8px;
  border-radius: 999px;
  box-shadow: 0 2px 8px rgba(0,0,0,.15);
  opacity: 0;
  transform: translateY(-6px) scale(.95);
  animation: badgeIn .28s ease forwards, badgeOut .35s ease 3.6s forwards; /* aparece y se va solo */
  pointer-events: none;
}

.q-card { position: relative; }

@keyframes badgeIn {
  0% { transform: scale(.6) translateY(-6px); opacity: 0; }
  80% { transform: scale(1.1); }
  100% { transform: scale(1) translateY(0); opacity: 1; }
}

@keyframes badgeOut {
  to { opacity: 0; transform: translateY(-6px) scale(.95); }
}

#screen-final {
  animation: fadeInZoom .4s ease;
}
@keyframes fadeInZoom {
  from { opacity: 0; transform: scale(.95); }
  to   { opacity: 1; transform: scale(1); }
}

/* Píldoras de mensaje (éxito / error) */
.msg {
  margin: 8px auto 12px;
  padding: 8px 12px;
  border-radius: 999px;
  font-weight: 600;
  font-size: 14px;
  width: fit-content;
  max-width: min(88vw, 560px);
  box-shadow: var(--shadow);
  opacity: 0;
  transform: translateY(-4px);
  animation: msgIn .28s ease forwards;
}
@keyframes msgIn {
  to { opacity: 1; transform: translateY(0); }
}
.msg-success {
  background: #e9f8ee;       /* verde muy claro */
  color: #176b2b;             /* verde texto */
  border: 1px solid #bfeccb;
}
.msg-error {
  background: #fff0f1;
  color: #7a1a22;
  border: 1px solid #ffd1d6;
}

/* Evitar que títulos largos queden apretados */
.q-card h2 {
  line-height: 1.25;
  word-wrap: break-word;
  overflow-wrap: anywhere;
  margin-bottom: 6px; /* espacio para la píldora */
}

/* Opcional: más aire entre barra y pregunta */
#capi-progress { margin-bottom: 16px; }


/* ===== Modo propuesta (tema especial) ===== */
body.proposal-mode{
  --bg: #fff1f6;           /* rosadito cálido */
  --primary: #d6336c;      /* frambuesa para títulos/botones */
}

#screen-proposal h2{
  letter-spacing: .3px;
  margin-bottom: 8px;
}

/* Frase "¿Querés ser mi novia?" palabra por palabra */
.proposal-phrase{
  font-weight: 700;
  font-size: clamp(24px, 6vw, 34px);
  line-height: 1.22;
  margin: 6px auto 8px;
}
.proposal-word{
  display: inline-block;
  opacity: 0;
  transform: translateY(8px) scale(.98);
}
@keyframes pWordIn{
  to{ opacity:1; transform: translateY(0) scale(1); }
}
.proposal-word.show{
  animation: pWordIn .42s ease forwards;
}

/* Opciones: aparición escalonada más suave en la propuesta */
#screen-proposal .options .opt{
  opacity: 0;
  transform: translateY(10px);
  animation: fadeUp .38s ease forwards;
}
#screen-proposal .options .opt:nth-child(1){ animation-delay: .2s; }
#screen-proposal .options .opt:nth-child(2){ animation-delay: .34s; }

/* Un poco más de aire arriba para que no quede brusco */
#screen-proposal{
  animation: fadeInZoom .45s ease;
}
@keyframes fadeInZoom{
  from{ opacity:0; transform: scale(.97); }
  to  { opacity:1; transform: scale(1); }
}

/* separador visual extra entre palabras de la propuesta */
.proposal-word + .proposal-word {
  margin-left: .4ch;
}

#capture-area {
  background: #fff0f6;
  border: 3px double #e63946;
  border-radius: 16px;
  padding: 24px;
  max-width: 400px;
  margin: 0 auto;
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  font-family: 'Poppins', sans-serif;
}

#capture-area h3 {
  font-family: 'Dancing Script', cursive;
  font-size: 1.8rem;
  margin-bottom: 10px;
  color: #e63946;
}

.cert-sub {
  font-size: 1rem;
  margin: 6px 0;
}

.cert-slogan {
  font-style: italic;
  font-size: 0.9rem;
  color: #555;
  margin-top: 12px;
}

.cert-footer {
  margin-top: 16px;
  font-size: 0.8rem;
  color: #999;
}

/* Video sorpresa: responsive + no cortado en móvil */
#video-surprise{
  display:block;
  width:min(560px, 92vw);
  max-height: calc(100svh - 180px); /* alto seguro en móvil */
  margin:16px auto 28px;
  border-radius:14px;
  background:#000;            /* por si hay letterbox */
  box-shadow: 0 8px 30px rgba(0,0,0,.15);
}

/* Ajustes por orientación del video (clases que ponemos con JS) */
#video-surprise.is-horizontal{
  aspect-ratio: 16/9;
  object-fit: contain;        /* que se vea entero sin recortar */
}
#video-surprise.is-vertical{
  aspect-ratio: 9/16;
  object-fit: contain;
}

/* iOS: cuando el teclado/toolbar cambia viewport, que no se tape */
@supports(height: 1svh){
  #video-surprise{ max-height: calc(100svh - 180px); }
}

/* Si el video tiene .hidden, que gane SIEMPRE */
#video-surprise.hidden { display: none !important; }
